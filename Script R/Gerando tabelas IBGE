#Carregando pacotes a serem utilizados----

    library(dplyr)
    library(stringr)

#Limpando bases da memória----

    rm(list=ls())

#Diretório local de trabalho----

    setwd("C:/Users/igorf/Documents/GitHub/dissertacao/dataset/ibge/area plantada")

#Organizando tabelas----

    #Área plantada por cultura em hectares----

    ano1 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2003%20tabela5457.csv"
    ano2 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2004%20tabela5457.csv"
    ano3 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2005%20tabela5457.csv"
    ano4 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2006%20tabela5457.csv"
    ano5 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2007%20tabela5457.csv"
    ano6 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2008%20tabela5457.csv"
    ano7 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2009%20tabela5457.csv"
    ano8 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2010%20tabela5457.csv"
    ano9 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2011%20tabela5457.csv"
    ano10 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2012%20tabela5457.csv"
    ano11 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2013%20tabela5457.csv"
    ano12 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2014%20tabela5457.csv"
    ano13 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2015%20tabela5457.csv"
    ano14 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2016%20tabela5457.csv"
    ano15 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/area%20plantada/2017%20tabela5457.csv"

#Tabela 2003

    h2003<-read.csv(ano1, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2003<-h2003[-1,]

    h2003<-h2003 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2003)

#Exportando

    write.table(h2003,file='area_plantada_2003.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2004

    h2004<-read.csv(ano2, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2004<-h2004[-1,]

    h2004<-h2004 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2004)

#Exportando

    write.table(h2004,file='area_plantada_2004.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2005

    h2005<-read.csv(ano3, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2005<-h2005[-1,]

    h2005<-h2005 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2005)

#Exportando

    write.table(h2005,file='area_plantada_2005.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2006

    h2006<-read.csv(ano4, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2006<-h2006[-1,]

    h2006<-h2006 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2006)

#Exportando

    write.table(h2006,file='area_plantada_2006.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2007

    h2007<-read.csv(ano5, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2007<-h2007[-1,]

    h2007<-h2007 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2007)

#Exportando

    write.table(h2007,file='area_plantada_2007.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2008

    h2008<-read.csv(ano6, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2008<-h2008[-1,]

    h2008<-h2008 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2008)

#Exportando

    write.table(h2008,file='area_plantada_2008.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2009

    h2009<-read.csv(ano7, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2009<-h2009[-1,]

    h2009<-h2009 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2009)

#Exportando

    write.table(h2009,file='area_plantada_2009.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2010

    h2010<-read.csv(ano8, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2010<-h2010[-1,]

    h2010<-h2010 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2010)

#Exportando

    write.table(h2010,file='area_plantada_2010.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2011

    h2011<-read.csv(ano9, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2011<-h2011[-1,]

    h2011<-h2011 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2011)

#Exportando

    write.table(h2011,file='area_plantada_2011.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2012

    h2012<-read.csv(ano10, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2012<-h2012[-1,]

    h2012<-h2012 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2012)

#Exportando

    write.table(h2012,file='area_plantada_2012.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2013

    h2013<-read.csv(ano11, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2013<-h2013[-1,]

    h2013<-h2013 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2013)

#Exportando

    write.table(h2013,file='area_plantada_2013.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2014

    h2014<-read.csv(ano12, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2014<-h2014[-1,]

    h2014<-h2014 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2014)

#Exportando

    write.table(h2014,file='area_plantada_2014.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2015

    h2015<-read.csv(ano13, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2015<-h2015[-1,]

    h2015<-h2015 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2015)

#Exportando

    write.table(h2015,file='area_plantada_2015.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2016

    h2016<-read.csv(ano14, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2016<-h2016[-1,]

    h2016<-h2016 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2016)

#Exportando

    write.table(h2016,file='area_plantada_2016.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2017

    h2017<-read.csv(ano15, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    h2017<-h2017[-1,]

    h2017<-h2017 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2017)

#Exportando

    write.table(h2017,file='area_plantada_2017.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Limpando bases da memória----

    rm(list=ls())

#Diretório local de trabalho----

    setwd("C:/Users/igorf/Documents/GitHub/dissertacao/dataset/ibge/quantidade produzida")

#Organizando tabelas----

    #Quantidade produzida por cultura em toneladas

    ano1 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2003%20tabela5457.csv"
    ano2 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2004%20tabela5457.csv"
    ano3 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2005%20tabela5457.csv"
    ano4 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2006%20tabela5457.csv"
    ano5 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2007%20tabela5457.csv"
    ano6 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2008%20tabela5457.csv"
    ano7 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2009%20tabela5457.csv"
    ano8 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2010%20tabela5457.csv"
    ano9 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2011%20tabela5457.csv"
    ano10 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2012%20tabela5457.csv"
    ano11 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2013%20tabela5457.csv"
    ano12 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2014%20tabela5457.csv"
    ano13 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2015%20tabela5457.csv"
    ano14 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2016%20tabela5457.csv"
    ano15 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/quantidade%20produzida/2017%20tabela5457.csv"

#Tabela 2003

    q2003<-read.csv(ano1, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2003<-q2003[-1,]

    q2003<-q2003 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2003)

#Exportando

    write.table(q2003,file='quantidade_produzida_2003.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2004

    q2004<-read.csv(ano2, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2004<-q2004[-1,]

    q2004<-q2004 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2004)

#Exportando

    write.table(q2004,file='quantidade_produzida_2004.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2005

    q2005<-read.csv(ano3, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2005<-q2005[-1,]

    q2005<-q2005 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2005)

#Exportando

    write.table(q2005,file='quantidade_produzida_2005.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2006

    q2006<-read.csv(ano4, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2006<-q2006[-1,]

    q2006<-q2006 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2006)

#Exportando

    write.table(q2006,file='quantidade_produzida_2006.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2007

    q2007<-read.csv(ano5, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2007<-q2007[-1,]

    q2007<-q2007 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2007)

#Exportando

    write.table(q2007,file='quantidade_produzida_2007.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2008

    q2008<-read.csv(ano6, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2008<-q2008[-1,]

    q2008<-q2008 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2008)

#Exportando

    write.table(q2008,file='quantidade_produzida_2008.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2009

    q2009<-read.csv(ano7, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2009<-q2009[-1,]

    q2009<-q2009 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2009)

#Exportando

    write.table(q2009,file='quantidade_produzida_2009.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2010

    q2010<-read.csv(ano8, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2010<-q2010[-1,]

    q2010<-q2010 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2010)

#Exportando

    write.table(q2010,file='quantidade_produzida_2010.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2011

    q2011<-read.csv(ano9, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2011<-q2011[-1,]

    q2011<-q2011 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2011)

#Exportando

    write.table(q2011,file='quantidade_produzida_2011.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2012

    q2012<-read.csv(ano10, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2012<-q2012[-1,]

    q2012<-q2012 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2012)

#Exportando

    write.table(q2012,file='quantidade_produzida_2012.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2013

    q2013<-read.csv(ano11, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2013<-q2013[-1,]

    q2013<-q2013 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2013)

#Exportando

    write.table(q2013,file='quantidade_produzida_2013.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2014

    q2014<-read.csv(ano12, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2014<-q2014[-1,]

    q2014<-q2014 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2014)

#Exportando

    write.table(q2014,file='quantidade_produzida_2014.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2015

    q2015<-read.csv(ano13, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2015<-q2015[-1,]

    q2015<-q2015 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2015)

#Exportando

    write.table(q2015,file='quantidade_produzida_2015.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2016

    q2016<-read.csv(ano14, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2016<-q2016[-1,]

    q2016<-q2016 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2016)

#Exportando

    write.table(q2016,file='quantidade_produzida_2016.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2017

    q2017<-read.csv(ano15, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    q2017<-q2017[-1,]

    q2017<-q2017 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2017)

#Exportando

    write.table(q2017,file='quantidade_produzida_2017.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Limpando bases da memória----

    rm(list=ls())

#Diretório local de trabalho----

    setwd("C:/Users/igorf/Documents/GitHub/dissertacao/dataset/ibge/valor da producao")

#Organizando tabelas----

    #Valor da produção por cultura em mil reais

    ano1 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2003%20tabela5457.csv"
    ano2 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2004%20tabela5457.csv"
    ano3 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2005%20tabela5457.csv"
    ano4 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2005%20tabela5457.csv"
    ano5 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2007%20tabela5457.csv"
    ano6 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2008%20tabela5457.csv"
    ano7 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2009%20tabela5457.csv"
    ano8 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2010%20tabela5457.csv"
    ano9 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2011%20tabela5457.csv"
    ano10 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2012%20tabela5457.csv"
    ano11 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2013%20tabela5457.csv"
    ano12 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2014%20tabela5457.csv"
    ano13 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2015%20tabela5457.csv"
    ano14 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2016%20tabela5457.csv"
    ano15 <- "https://raw.githubusercontent.com/igorfdeoliv/dissertacao/main/dataset/ibge/valor%20da%20producao/2017%20tabela5457.csv"

#Tabela 2003

    v2003<-read.csv(ano1, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2003<-v2003[-1,]

    v2003<-v2003 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2003)

#Exportando

    write.table(v2003,file='valor_produção_2003.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2004

    v2004<-read.csv(ano2, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2004<-v2004[-1,]

    v2004<-v2004 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2004)

#Exportando

    write.table(v2004,file='valor_produção_2004.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2005

    v2005<-read.csv(ano3, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2005<-v2005[-1,]

    v2005<-v2005 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2005)

#Exportando

    write.table(v2005,file='valor_produção_2005.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2006

    v2006<-read.csv(ano4, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2006<-v2006[-1,]

    v2006<-v2006 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2006)

#Exportando

    write.table(v2006,file='valor_produção_2006.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2007

    v2007<-read.csv(ano5, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2007<-v2007[-1,]

    v2007<-v2007 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2007)

#Exportando

    write.table(v2007,file='valor_produção_2007.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2008

    v2008<-read.csv(ano6, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2008<-v2008[-1,]

    v2008<-v2008 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2008)

#Exportando

    write.table(v2008,file='valor_produção_2008.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2009

    v2009<-read.csv(ano7, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2009<-v2009[-1,]

    v2009<-v2009 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2009)

#Exportando

    write.table(v2009,file='valor_produção_2009.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2010

    v2010<-read.csv(ano8, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2010<-v2010[-1,]

    v2010<-v2010 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2010)

#Exportando

    write.table(v2010,file='valor_produção_2010.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2011

    v2011<-read.csv(ano9, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2011<-v2011[-1,]

    v2011<-v2011 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2011)

#Exportando

    write.table(v2011,file='valor_produção_2011.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2012

    v2012<-read.csv(ano10, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2012<-v2012[-1,]

    v2012<-v2012 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2012)

#Exportando

    write.table(v2012,file='valor_produção_2012.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2013

    v2013<-read.csv(ano11, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2013<-v2013[-1,]

    v2013<-v2013 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2013)

#Exportando

    write.table(v2013,file='valor_produção_2013.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2014

    v2014<-read.csv(ano12, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2014<-v2014[-1,]

    v2014<-v2014 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2014)

#Exportando

    write.table(v2014,file='valor_produção_2014.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2015

    v2015<-read.csv(ano13, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2015<-v2015[-1,]

    v2015<-v2015 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2015)

#Exportando

    write.table(v2015,file='valor_produção_2015.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2016

    v2016<-read.csv(ano14, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2016<-v2016[-1,]

    v2016<-v2016 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2016)

#Exportando

    write.table(v2016,file='valor_produção_2016.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)

#Tabela 2017

    v2017<-read.csv(ano15, header=T, sep=";",dec = ",", skip = 3,nrows = 5564,
                na.strings = c("-","..."), encoding = "UTF-8")

    v2017<-v2017[-1,]

    v2017<-v2017 %>% 
    mutate(Município=toupper(Município)) %>% 
    mutate(Município=chartr("ÁÉÍÓÚÃÕÂÊÔÇ'", "AEIOUAOAEOC ", Município)) %>%
    mutate("ano"=2017)

#Exportando

    write.table(v2017,file='valor_produção_2017.csv',sep=';',dec=".",na="0",quote=TRUE, row.names=FALSE)